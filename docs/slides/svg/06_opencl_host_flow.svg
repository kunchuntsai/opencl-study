<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080">
  <defs>
    <marker id="arrow" markerWidth="12" markerHeight="9" refX="11" refY="4.5" orient="auto">
      <polygon points="0 0, 12 4.5, 0 9" fill="#ffbb62"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1920" height="1080" fill="#ffffff"/>

  <!-- Title -->
  <text x="960" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="48" font-weight="bold" fill="#666666">Current OpenCL Host Call Flow</text>
  <text x="960" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" fill="#8b7355">(Monolithic Architecture - 6 Steps)</text>

  <!-- ============ INPUTS (Left) ============ -->
  <text x="200" y="170" text-anchor="middle" font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="#666666">INPUTS</text>

  <rect x="60" y="190" width="180" height="70" rx="10" fill="#fff8f0" stroke="#ffbb62" stroke-width="3"/>
  <text x="150" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#666666">kernel.cl</text>
  <text x="150" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#666666">Source code</text>

  <rect x="260" y="190" width="180" height="70" rx="10" fill="#fff8f0" stroke="#ffbb62" stroke-width="3"/>
  <text x="350" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#666666">config.json</text>
  <text x="350" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#666666">Configuration</text>

  <rect x="60" y="280" width="180" height="70" rx="10" fill="#fff8f0" stroke="#ffbb62" stroke-width="3"/>
  <text x="150" y="315" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#666666">input.bin</text>
  <text x="150" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#666666">Image data</text>

  <!-- Arrow from inputs to main flow -->
  <line x1="450" y1="280" x2="530" y2="280" stroke="#666666" stroke-width="4" marker-end="url(#arrow)"/>

  <!-- ============ Main Flow Box ============ -->
  <rect x="540" y="140" width="920" height="800" rx="20" fill="#fff" stroke="#ffbb62" stroke-width="4"/>
  <text x="1000" y="190" text-anchor="middle" font-family="Arial, sans-serif" font-size="32" font-weight="bold" fill="#666666">opencl_host (Monolithic)</text>

  <!-- Step 1: OpenCL Initialization -->
  <rect x="600" y="220" width="800" height="85" rx="10" fill="#fff8f0" stroke="#ffbb62" stroke-width="2"/>
  <text x="640" y="265" font-family="Arial, sans-serif" font-size="26" font-weight="bold" fill="#666666">1</text>
  <text x="1000" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#666666">OpenCL Initialization</text>
  <text x="1000" y="285" text-anchor="middle" font-family="monospace" font-size="14" fill="#666666">clGetPlatformIDs() -> clGetDeviceIDs() -> clCreateContext() -> clCreateCommandQueue()</text>

  <line x1="1000" y1="305" x2="1000" y2="330" stroke="#666666" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Step 2: Build Program (JIT) - HIGHLIGHTED -->
  <rect x="600" y="340" width="800" height="95" rx="10" fill="#ffbb62" stroke="#666666" stroke-width="4"/>
  <text x="640" y="390" font-family="Arial, sans-serif" font-size="26" font-weight="bold" fill="#666666">2</text>
  <text x="1000" y="375" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#666666">Build Program (JIT) - SLOW!</text>
  <text x="1000" y="405" text-anchor="middle" font-family="monospace" font-size="14" fill="#666666">LoadConfig() -> clCreateProgramWithSource() -> clBuildProgram() -> clCreateKernel()</text>
  <text x="1000" y="425" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-style="italic" fill="#666666">~100ms compilation time</text>

  <line x1="1000" y1="435" x2="1000" y2="460" stroke="#666666" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Step 3: Create Buffers -->
  <rect x="600" y="470" width="800" height="85" rx="10" fill="#fff8f0" stroke="#ffbb62" stroke-width="2"/>
  <text x="640" y="515" font-family="Arial, sans-serif" font-size="26" font-weight="bold" fill="#666666">3</text>
  <text x="1000" y="505" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#666666">Create Buffers</text>
  <text x="1000" y="535" text-anchor="middle" font-family="monospace" font-size="14" fill="#666666">clCreateBuffer(INPUT) -> clCreateBuffer(OUTPUT) -> clEnqueueWriteBuffer()</text>

  <line x1="1000" y1="555" x2="1000" y2="580" stroke="#666666" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Step 4: Set Kernel Arguments -->
  <rect x="600" y="590" width="800" height="85" rx="10" fill="#fff8f0" stroke="#ffbb62" stroke-width="2"/>
  <text x="640" y="635" font-family="Arial, sans-serif" font-size="26" font-weight="bold" fill="#666666">4</text>
  <text x="1000" y="625" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#666666">Set Kernel Arguments</text>
  <text x="1000" y="655" text-anchor="middle" font-family="monospace" font-size="14" fill="#666666">clSetKernelArg(0, input) -> clSetKernelArg(1, output) -> clSetKernelArg(2, params)...</text>

  <line x1="1000" y1="675" x2="1000" y2="700" stroke="#666666" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Step 5: Execute Kernel -->
  <rect x="600" y="710" width="800" height="85" rx="10" fill="#ffbb62" stroke="#666666" stroke-width="2"/>
  <text x="640" y="755" font-family="Arial, sans-serif" font-size="26" font-weight="bold" fill="#666666">5</text>
  <text x="1000" y="745" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#666666">Execute Kernel</text>
  <text x="1000" y="775" text-anchor="middle" font-family="monospace" font-size="14" fill="#666666">clEnqueueNDRangeKernel() -> clEnqueueReadBuffer()</text>

  <line x1="1000" y1="795" x2="1000" y2="820" stroke="#666666" stroke-width="3" marker-end="url(#arrow)"/>

  <!-- Step 6: Finalize & Release -->
  <rect x="600" y="830" width="800" height="85" rx="10" fill="#fff8f0" stroke="#ffbb62" stroke-width="2"/>
  <text x="640" y="875" font-family="Arial, sans-serif" font-size="26" font-weight="bold" fill="#666666">6</text>
  <text x="1000" y="865" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#666666">Finalize &amp; Release</text>
  <text x="1000" y="895" text-anchor="middle" font-family="monospace" font-size="14" fill="#666666">clFinish() -> clReleaseKernel() -> clReleaseMemObject() -> clReleaseContext()</text>

  <!-- Arrow to output -->
  <line x1="1400" y1="872" x2="1500" y2="872" stroke="#666666" stroke-width="4"/>
  <line x1="1500" y1="872" x2="1500" y2="340" stroke="#666666" stroke-width="4"/>
  <line x1="1500" y1="340" x2="1620" y2="340" stroke="#666666" stroke-width="4" marker-end="url(#arrow)"/>

  <!-- ============ OUTPUT (Right) ============ -->
  <text x="1750" y="170" text-anchor="middle" font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="#666666">OUTPUT</text>
  <rect x="1640" y="190" width="200" height="300" rx="10" fill="#ffbb62" stroke="#666666" stroke-width="3"/>
  <text x="1740" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#666666">result.bin</text>
  <text x="1740" y="370" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#666666">Processed data</text>

  <!-- ============ Problem Callout ============ -->
  <rect x="60" y="420" width="400" height="260" rx="12" fill="#fff8f0" stroke="#ffbb62" stroke-width="3"/>
  <text x="260" y="465" text-anchor="middle" font-family="Arial, sans-serif" font-size="26" font-weight="bold" fill="#666666">Problems</text>

  <text x="90" y="510" font-family="Arial, sans-serif" font-size="18" fill="#666666">1. Compiles every run (~100ms)</text>
  <text x="90" y="545" font-family="Arial, sans-serif" font-size="18" fill="#666666">2. Source code required on target</text>
  <text x="90" y="580" font-family="Arial, sans-serif" font-size="18" fill="#666666">3. Compile + Execute coupled</text>
  <text x="90" y="615" font-family="Arial, sans-serif" font-size="18" fill="#666666">4. Can't pre-compile for device</text>
  <text x="90" y="650" font-family="Arial, sans-serif" font-size="18" fill="#666666">5. No binary-only deployment</text>

  <!-- Code reference -->
  <rect x="60" y="720" width="400" height="80" rx="10" fill="#fff8f0" stroke="#ffbb62" stroke-width="2"/>
  <text x="260" y="760" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#666666">Code: algorithm_runner.c</text>
  <text x="260" y="788" text-anchor="middle" font-family="monospace" font-size="16" fill="#666666">RunAlgorithm()</text>
</svg>
