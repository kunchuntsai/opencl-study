{
    "input": {
        "input_image_id": "lucas_kanade_input"
    },

    "output": {
        "output_image_id": "lucas_kanade_output"
    },

    "verification": {
        "tolerance": 1,
        "error_rate_threshold": 0.05,
        "golden_source": "file",
        "golden_file": "test_data/lucas_kanade/golden_flow_x.bin"
    },

    "scalars": {
        "window_size": {"type": "int", "value": 5},
        "max_iters": {"type": "int", "value": 10}
    },

    "buffers": {
        "i_prev_frame": {
            "type": "READ_ONLY",
            "data_type": "uchar",
            "source_file": "test_data/lucas_kanade/prev_frame.bin",
            "size_expr": "src_width * src_height"
        },
        "i_curr_frame": {
            "type": "READ_ONLY",
            "data_type": "uchar",
            "source_file": "test_data/lucas_kanade/curr_frame.bin",
            "size_expr": "src_width * src_height"
        },
        "o_flow_x": {
            "type": "WRITE_ONLY",
            "data_type": "float",
            "size_expr": "src_width * src_height * 4"
        },
        "o_flow_y": {
            "type": "WRITE_ONLY",
            "data_type": "float",
            "size_expr": "src_width * src_height * 4"
        },
        "o_magnitude": {
            "type": "WRITE_ONLY",
            "data_type": "float",
            "size_expr": "src_width * src_height * 4"
        },
        "o_angle": {
            "type": "WRITE_ONLY",
            "data_type": "float",
            "size_expr": "src_width * src_height * 4"
        }
    },

    "kernels": {
        "v0": {
            "description": "Lucas-Kanade optical flow (basic)",
            "host_type": "standard",
            "kernel_option": "",
            "kernel_file": "examples/lucas_kanade/cl/lucas_kanade0.cl",
            "kernel_function": "lucas_kanade",
            "work_dim": 2,
            "global_work_size": [1920, 1088],
            "local_work_size": [16, 16],
            "kernel_args": [
                {"buffer": ["uchar", "i_prev_frame", 2073600]},
                {"buffer": ["uchar", "i_curr_frame", 2073600]},
                {"buffer": ["float", "o_flow_x", 8294400]},
                {"buffer": ["float", "o_flow_y", 8294400]},
                {"param": ["int", "src_width"]},
                {"param": ["int", "src_height"]},
                {"param": ["int", "window_size"]}
            ],
            "verification": {
                "golden_file": "test_data/lucas_kanade/golden_flow_x.bin",
                "output_buffer": "o_flow_x"
            }
        },
        "v1": {
            "description": "Lucas-Kanade with iterative refinement",
            "host_type": "standard",
            "kernel_option": "",
            "kernel_file": "examples/lucas_kanade/cl/lucas_kanade0.cl",
            "kernel_function": "lucas_kanade_iterative",
            "work_dim": 2,
            "global_work_size": [1920, 1088],
            "local_work_size": [16, 16],
            "kernel_args": [
                {"buffer": ["uchar", "i_prev_frame", 2073600]},
                {"buffer": ["uchar", "i_curr_frame", 2073600]},
                {"buffer": ["float", "o_flow_x", 8294400]},
                {"buffer": ["float", "o_flow_y", 8294400]},
                {"param": ["int", "src_width"]},
                {"param": ["int", "src_height"]},
                {"param": ["int", "window_size"]},
                {"param": ["int", "max_iters"]}
            ],
            "verification": {
                "golden_file": "test_data/lucas_kanade/golden_flow_x.bin",
                "output_buffer": "o_flow_x"
            }
        },
        "v2": {
            "description": "Lucas-Kanade with Gaussian weighting",
            "host_type": "standard",
            "kernel_option": "",
            "kernel_file": "examples/lucas_kanade/cl/lucas_kanade0.cl",
            "kernel_function": "lucas_kanade_gaussian",
            "work_dim": 2,
            "global_work_size": [1920, 1088],
            "local_work_size": [16, 16],
            "kernel_args": [
                {"buffer": ["uchar", "i_prev_frame", 2073600]},
                {"buffer": ["uchar", "i_curr_frame", 2073600]},
                {"buffer": ["float", "o_flow_x", 8294400]},
                {"buffer": ["float", "o_flow_y", 8294400]},
                {"param": ["int", "src_width"]},
                {"param": ["int", "src_height"]}
            ]
        },
        "v3_polar": {
            "description": "Flow to polar (magnitude/angle)",
            "host_type": "standard",
            "kernel_option": "",
            "kernel_file": "examples/lucas_kanade/cl/lucas_kanade0.cl",
            "kernel_function": "flow_to_polar",
            "work_dim": 2,
            "global_work_size": [1920, 1088],
            "local_work_size": [16, 16],
            "requires_pre_kernel": "v0",
            "kernel_args": [
                {"buffer": ["float", "o_flow_x", 8294400]},
                {"buffer": ["float", "o_flow_y", 8294400]},
                {"buffer": ["float", "o_magnitude", 8294400]},
                {"buffer": ["float", "o_angle", 8294400]},
                {"param": ["int", "src_width"]},
                {"param": ["int", "src_height"]}
            ]
        }
    }
}
